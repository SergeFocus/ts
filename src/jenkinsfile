pipeline {
    agent {
        leabel 'bdd'
    }
    stages{
        stage('Обновление тестового контура'){
            steps {
            bat """
            oscript --version
            """
            cmd("deployka loadrepo \"/FF:/mitest/workspace/1c_trade_bdd\" \"F:/mitest/workspace/storage_trade\" -storage-user ci-bot -storage-pwd password -v8version 8.3.10\"")
            cmd("deployka dbupdate \"/FF:/mitest/workspace/1c_trade_bdd\" -allow-warnings -v8version 8.3.10\"")
                }
            }
    }

}

def cmd() {
    if(isUnix()){
        sh "${command}"
    } else {
        bat "chcp 65001\n${command}"
    }
}